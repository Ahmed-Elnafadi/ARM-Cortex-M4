/********************************************************************************************************************************
 *  FILE DESCRIPTION
 *  ---------------------------------------------------------------------------------------------------------------------------*/
/**			\file SST_Ctrl.c

 *          \brief Systick core peripheral
 *
 *			\details Driver configure Time that Systick will count
 *                   
 *
 *******************************************************************************************************************************/
 
/*******************************************************************************************************************************
 * INCLUDES
 ******************************************************************************************************************************/
 #include "STD_TYPES.h"
 #include "BIT_MATH.h"
 #include "SST_Ctrl.h"
 #include "SST_Cfg.h"
 #include "SST_Types.h"
 #include "SST_Hw.h"
 
 
 
/*******************************************************************************************************************************
 * LOCAL MACROS CONSTANT\FUNCTION
 ******************************************************************************************************************************/
  

/*******************************************************************************************************************************
 * LOCAL DATA
 ******************************************************************************************************************************/


/*******************************************************************************************************************************
 * GLOBAL DATA
 ******************************************************************************************************************************/


/*******************************************************************************************************************************
 * LOCAL FUNCTION PROTOTYPES
 ******************************************************************************************************************************/


/*******************************************************************************************************************************
 * LOCAL FUNCTIONS
 ******************************************************************************************************************************/
  
  
/*******************************************************************************************************************************
 * GLOBAL FUNCTIONS
 ******************************************************************************************************************************/
 


/*******************************************************************************************************************************
 * \Syntax			: void SST_Init(void)
 * \Description     : Initialize Systick configuration
 *  				  
 *
 * \Sync\Async      : Synchronous
 * \Reentrancy		: Non Reentrant
 * \Parameters (in) : None
 * \parameters (out): None
 * \Return Value    : None
 *******************************************************************************************************************************/
void SST_Init(void){
	
	/* Implement Code */
/* Choose Clock Source */
#if SYSTICK_CLK == PRECISION_INTERNAL_OSCILLATOR_DIVIDED_BY_4
CLR_BIT(STCTRL, CLK_SRC);
#elif SYSTICK_CLK == SYSTEM_CLOCK
SET_BIT(STCTRL, CLK_SRC);
#else
	#error "Wrong Configuration"
#endif

/* Choose Interrupt Enable */

#if SYSTICK_INT_EN == ENABLE
SET_BIT(STCTRL, INTEN);
#elif SYSTICK_INT_EN == DISABLE
CLR_BIT(STCTRL, INTEN);
#else
	#error "Wrong Configuration"
#endif
/* Systick Enable or Disable */

#if SYSTICK_EN == ENABLE
SET_BIT(STCTRL, ENABLE_S);
#elif SYSTICK_EN == DISABLE
CLR_BIT(STCTRL, ENABLE_S);
#else
	#error "Wrong Configuration"
#endif
}  

/*******************************************************************************************************************************
 * \Syntax			: void SST_SetTime(uint32_t copy_Time)
 * \Description     : Set Time
 *  				  
 *
 * \Sync\Async      : Synchronous
 * \Reentrancy		: Non Reentrant
 * \Parameters (in) : Time in msec
 * \parameters (out): None
 * \Return Value    : None
 *******************************************************************************************************************************/
void SST_SetTime(uint32_t copy_Time){
	uint32_t Counts = 0;
	if(copy_Time > 4195){
		/* Wrong */
		
	}
	else{
		
		Counts = (uint32_t)((copy_Time*16777.215)/4.19430375);
		STRELOAD = Counts;
		/* Enable Systick */
		SET_BIT(STCTRL, ENABLE_S);
	}
	while(GET_BIT(STCTRL, COUNT)!= 1);
}

/*******************************************************************************************************************************
 * \Syntax			: void SST_GetTime(void)
 * \Description     : get Time
 *  				  
 *
 * \Sync\Async      : Synchronous
 * \Reentrancy		: Non Reentrant
 * \Parameters (in) : None
 * \parameters (out): None
 * \Return Value    : Time in msec
 *******************************************************************************************************************************/
uint32_t SST_GetTime(void){

	return (uint32_t)((STCURRENT*4.19430375)/16777.215);
}



void SysTick_Handler(void){
	/* Write anything  */
	STCURRENT = 0x00121111;

}
/********************************************************************************************************************************
 * END OF FILE: SST_Ctrl.c
 *******************************************************************************************************************************/ 